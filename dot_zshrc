# Apply colours from pywal
cat ~/.cache/wal/sequences

# === zsh options === #
setopt autocd
setopt correct

# Set emacs mode (what is changing it to vi mode?)
bindkey -e
autoload -U select-word-style
select-word-style bash

# Bind M-. and M-, | Source: https://stackoverflow.com/a/34861762/9327802
autoload -Uz copy-earlier-word
zle -N copy-earlier-word
# bindkey "^[." insert-last-word
bindkey "^[," copy-earlier-word

# Load cdr
autoload -Uz chpwd_recent_dirs cdr add-zsh-hook
add-zsh-hook chpwd chpwd_recent_dirs

# Use dynamic directories e.g. ~[1], ~[2] etc.
add-zsh-hook -Uz zsh_directory_name zsh_directory_name_cdr

# Set completion style to menu
zstyle ':completion:*:*:cdr:*:*' menu selection

# === zinit === #
source ~/zsh-scripts/init_zinit.sh

# Load prompt
zinit load "agkozak/agkozak-zsh-prompt"

zinit load "MikeDacre/careful_rm"

# Load asynchronously
zinit wait lucid for \
  "MikeDacre/cdbk" \
  "MichaelAquilina/zsh-you-should-use" \
  "zsh-users/zsh-autosuggestions" \
  atinit'zpcompinit' "zdharma/fast-syntax-highlighting"

# Make careful_rm -c default for $HOME
[ ! -f "$HOME/.rm_recycle_home" ] && touch "$HOME/.rm_recycle_home"

# Make less more friendly for non-text input files, see lesspipe(1)
[ -x /usr/bin/lesspipe ] && eval "$(SHELL=/bin/sh lesspipe)"

# # ex - archive extractor
# # usage: ex <file>
ex() {
  if [ -f $1 ]; then
    case $1 in
    *.tar.bz2) tar xjf $1 ;;
    *.tar.gz) tar xzf $1 ;;
    *.bz2) bunzip2 $1 ;;
    *.rar) unrar x $1 ;;
    *.gz) gunzip $1 ;;
    *.tar) tar xf $1 ;;
    *.tbz2) tar xjf $1 ;;
    *.tgz) tar xzf $1 ;;
    *.zip) unzip $1 ;;
    *.Z) uncompress $1 ;;
    *.7z) 7z x $1 ;;
    *) echo "'$1' cannot be extracted via ex()" ;;
    esac
  else
    echo "'$1' is not a valid file"
  fi
}

# === Activate scripts === #
scripts=(

  # Adds function for checking if given command is available. Required by debian-arch-bridge.sh
  ~/scripts/cmd_available.sh

  # Adds apt ↔ yay bridge [WIP]
  ~/scripts/debian-arch-bridge.sh

  # Private things. Don't upload!
  ~/scripts/private.sh

  # Open file in background without output using xdg-open
  ~/scripts/x.sh

  # Apply fzf shortcuts e.g. M-c — go to file
  ~/.fzf.zsh

  # Load aliases (file is compatible with both bash and zsh)
  ~/.aliases

  # Load the calc plugin
  ~/zsh-scripts/calc.sh

  # Load the zmv command
  ~/zsh-scripts/zmv.sh

)
for script in ${scripts[@]}; do

  # -s: True if file exists and has a size greater than zero.
  # Source: https://www.gnu.org/software/bash/manual/html_node/Bash-Conditional-Expressions.html
  # if [ -s "$script" ]; then
    source "$script"
  # fi

done

# Fuck it
eval "$(thefuck --alias)"

# Init completions
zpcompinit
zinit cdreplay -q

# If I make another tool than needs to be at the end, then what?
if [ ! -d "/home/nawordar/.sdkman" ]; then
  return 0
fi

#THIS MUST BE AT THE END OF THE FILE FOR SDKMAN TO WORK!!!
export SDKMAN_DIR="/home/nawordar/.sdkman"
[[ -s "/home/nawordar/.sdkman/bin/sdkman-init.sh" ]] && source "/home/nawordar/.sdkman/bin/sdkman-init.sh"
